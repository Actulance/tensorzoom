# TensorZoom-TF

This is a Tensorflow project of super resolution that implemented the paper [Photo-Realistic Single Image Super-Resolution Using a Generative Adversarial Network](https://arxiv.org/abs/1609.04802). The super resolution network can scale up an image by 4 time its width and height and it has significantly better result compairing with bilinear scale up of an image. The training process is based on adversarial training that use a discriminative netowrk and a generative network alternatively in order to achieve a better visual result.

This implementation used only 6 batch normalistion layers in order to make the network suitable for mobile usage. This implementation also added a additional deblur training in order to improve the result from images taken from camera.


Here are some sample result generated by this algorithm.(click to download the full size to see the result)
<table>
  <tr>
    <td><img src="https://github.com/machrisaa/tensorzoom/blob/master/analysis/cat_h.jpg?raw=true"/></td>
    <td><img src="https://github.com/machrisaa/tensorzoom/blob/master/analysis/cat_h_tz6-s-stitch-gen.jpg?raw=true"/></td>
  </tr>
</table>
<table>
  <tr>
    <td><img src="https://github.com/machrisaa/tensorzoom/blob/master/analysis/london2.jpg?raw=true"/></td>
    <td><img src="https://github.com/machrisaa/tensorzoom/blob/master/analysis/london2_tz6-s-stitch-sblur-notv-gen.jpg?raw=true"/></td>
  </tr>
</table>

##How to use
To test scaling up an image is simple and do not require extra files and project. An example is provided in ```net_analysis.py```.

To train the network need to change the setup in ```trainer.py```:
```
# https://github.com/machrisaa/tensorflow-vgg
VGG_NPY_PATH = '../tensoflow_vgg/vgg19.npy'

# http://msvocds.blob.core.windows.net/coco2014/train2014.zip
COCO2014_PATH = '../../datasets/coco2014/train2014'
```
The training need to use a the result of the conv2_2 layer from a pre-trained VGG19 network - [Tensorflow-VGG](https://github.com/machrisaa/tensorflow-vgg). The dataset we are using is the Microsoft Coco2014 data set - [2014 Training images [80K/13GB] data set](http://mscoco.org/dataset/#download).
Download and update the path in ```trainer.py``` before start running this file.


